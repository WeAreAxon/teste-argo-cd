name: CD
on:
    push:
            branches: master
jobs:
  retrieve-secret:
    runs-on: ubuntu-latest
    steps:
      - name: Retrieve secret from Vault
        uses: hashicorp/vault-action@v2.7.3
        with:
            method: github
            url: https://vault.axonlab.com.br
            githubToken: ${{ secrets.TOKEN }}
            secrets: |
                    secret/production teste | TESTE
                    
      - name: Exibir a secret
        run: |  
            echo "Minha linda secret: $TESTE"
            cd k8s
            kustomize edit set image goapp=josealceu/argocd:$TESTE
            cat kustomization.yaml


                    
        
                    
